window.tuts={feed:undefined,feeddfr:$.Deferred(),authors:undefined,authordfr:$.Deferred(),tmpl:undefined,tmpldfr:$.Deferred(),init:function(){google.load("feeds","1");google.setOnLoadCallback(function(){var a=new google.feeds.Feed("http://updates.html5rocks.com/feeds/atom.xml");a.setNumEntries(1000);a.load(function(b){tuts.feed=b.feed;tuts.feeddfr.resolve()})});$.getJSON("/api/authors",function(a){tuts.authors=a;tuts.authordfr.resolve()});$.get("/static/js/tutorialtmpl.html",{dataType:"plain"},function(a){tuts.tmpl=Handlebars.compile(a);tuts.tmpldfr.resolve()});$.when(tuts.feeddfr.promise(),tuts.authordfr.promise(),tuts.tmpldfr.promise()).done(tuts.compile)},compile:function(){tuts.normalize();var a=tuts.tmpl({updates:tuts.feed.entries});$("#index").append(a);tuts.resort()},normalize:function(){tuts.feed.entries=tuts.feed.entries.map(function(d){if(d.author=="ebidelman"){d.author="ericbidelman"}var b=tuts.authors[d.author];d.fullname=b.given_name+" "+b.family_name;var a=["January","February","March","April","May","June","July","August","September","October","November","December"];var c=d.date=new Date(d.publishedDate);d.formattedDateStr=a[c.getMonth()].slice(0,3)+". "+c.getDate()+", "+c.getFullYear();d.categories=d.categories.map(function(e){return e.replace(/,/g,"").trim()});d.tags=d.categories.join(", ");return d})},resort:function(){var a=$(".tutorial_listing");a=a.each(function(c,d){var b=new Date(d.getAttribute("data-pubdate"));console.log(b.toString());$.data(d,"date",b)}).get().sort(function(d,c){return $.data(d,"date")>$.data(c,"date")?-1:1});$(a).appendTo("#index")}};tuts.init();$(document).ready(function(){$(".tag").click(function(){filterTag(this.textContent)});$('section.filter input[type="checkbox"]').click(filterTag);if(window.location.hash){filterTag(window.location.hash.substring(1))}});function clearFilter(){$(".tutorial_listing.hidden").removeClass("hidden");$("#updates_tag_filter").val("");$('section.filter input[type="checkbox"]').attr("checked",false);$("#filter").parent().addClass("hidden");if(!!window.history){var a=document.documentElement.lang||"en";history.replaceState({},document.title,"/"+a+"/tutorials")}else{window.location.hash=""}}var times=0;function filterTag(n){var h=window.event;if(!h||h.type=="hashchange"){return}console.log("called: "+ ++times);var k=$(".tutorial_listing");k.addClass("hidden");if((!n||typeof(n)!="string")&&window.location.hash){n=window.location.hash.substring(1)}if(n&&typeof(n)=="string"&&n.length){n=n.toLowerCase();k=k.find('span.tag:contains("'+n+'")').closest(".tutorial_listing");window.location.hash=n;$("#filter_tag").text(n);$("#filter").parent().removeClass("hidden")}var g=[];$('#updates_format_filter input[type="checkbox"]:checked').each(function(e,r){var j=r.parentElement.textContent;g.push($.trim(j).toLowerCase().replace(" ",""))});var f=[];$('#updates_audience_filter input[type="checkbox"]:checked').each(function(e,j){f.push($.trim(j.parentElement.textContent).toLowerCase())});var m=[];$('#updates_technology_filter input[type="checkbox"]:checked').each(function(e,j){m.push(j.value)});var q=$("#updates_tag_filter")[0].value;var l=q?q.toLowerCase().split(","):[];for(var d=0;d<k.length;d++){var b=true;var o=k[d];if((g.length>0)&&(g.indexOf(o.dataset.type)<0)){b=false}if(b&&(f.length>0)){var a=false;for(var c=0;c<f.length;c++){if($('span.tag:contains("'+f[c]+'")',o).length>0){a=true;break}}b=a}if(b&&(m.length>0)){var a=false;var p=o.dataset.classes.split(",");for(var c=0;c<m.length;c++){if(p.indexOf(m[c])>=0){a=true;break}}b=a}if(b&&(q)){var a=false;for(var c=0;c<l.length;c++){if((l[c].length>0)&&$('span.tag:contains("'+l[c]+'")',o).length>0){a=true;break}}b=a}if(b){o.classList.remove("hidden")}}}window.addEventListener("hashchange",function(a){filterTag(window.location.hash.substring(1));if(window._gaq){_gaq.push(["_trackPageview",window.location.href])}},false);