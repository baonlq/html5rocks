var AJAXIFY_SITE=false;$(".main nav ul li a").click(function(){$(".main nav .current").removeClass("current");if(AJAXIFY_SITE){$(this).addClass("current")}setTimeout("$('.watermark').css('top', '30px')",1000)});$(".subheader.features ul li a").click(function(){$(".main nav .current").removeClass("current");setTimeout("$('.watermark').css('top', '30px')",1000)});function finishPanelLoad(b,a){$(".page").removeClass("current");b.addClass("current");$.scrollTo(b,600,{queue:true,offset:{top:-60,left:0},onAfter:function(){$(".subheader.features").slideUp("fast",function(){if(a.popped!="popped"){state.push(a)}route.init(page)})}})}$(document).keydown(function(a){if(a.keyCode===27){$("#search_hide, #features_hide").click();$(".outline_nav_toggle").removeClass("activated").find("nav.outline").fadeOut("fast")}});if(AJAXIFY_SITE){$("a").click(function(){if($(this).attr("target")){return true}if(!Modernizr.history){return true}loadContent(this);return false})}function loadContent(c,b){window.page=c.pathname.replace(/\/\w{2,3}\//gi,"").replace(/\/([A-Za-z]+)/gi,"-$1").replace(/(\/$)|(^-)/g,"").split("#")[0];window.pagePanel=$(".page#"+page);var a=c.href;var d=a.split("#")[1];var f={href:a,hash:d,popped:b,title:page[0].toUpperCase()+page.substring(1)};if(page==""){location.href="/";return false}$("body").attr("data-href",page);if(d){var e=pagePanel.find("."+d);if(e.length){finishPanelLoad(e,f)}return false}if(pagePanel.hasClass("loaded")){finishPanelLoad(pagePanel,f)}else{pagePanel.addClass("loaded").load(a+" [data-import-html]",function(){finishPanelLoad(pagePanel,f)})}}$(".outline_nav_toggle").click(function(a){$(this).toggleClass("activated");$(this).find("nav.outline").fadeToggle("fast")});$("nav.features_outline a.section_title").click(function(a){if($(this).parent("li").hasClass("current")){$(this).parent("li").removeClass("current");$(this).siblings("ul").slideUp("fast")}else{$("nav.features_outline li").removeClass("current");$("nav.features_outline a.section_title").siblings("ul").slideUp("fast");$(this).parent("li").addClass("current");$(this).siblings("ul").slideDown("fast")}a.stopPropagation()});window.route={common:function(){},home:function(){$.getScript(feed.pipeURL+"_callback=feed.home")},tutorials:function(){},features:function(){window.loadFeaturePanels&&loadFeaturePanels()},init:function(b){var a=route[b.split("-")[0]],c=route[b];route.fire(route.common);route.fire(a);if(c!=a){route.fire(c)}},fire:function(a){if(typeof a=="function"){a.call(route)}},onload:function(){route.init(document.body.getAttribute("data-href"))}};window.state={push:function(a){if(!Modernizr.history){return}history.pushState(a,"",a.href);document.title="HTML5 Rocks - "+a.title},popstate:function(b){if(!(b&&b.state)){return}var a=document.createElement("a");a.href=b.state.href;document.title="HTML5 Rocks - "+b.state.title;loadContent(a,"popped")},handleEvent:function(a){state[a.type].call(state,a)}};window.feed={pipeURL:"http://pipes.yahoo.com/pipes/pipe.run?_id=            647030be6aceb6d005c3775a1c19401c&_render=json&",home:function(a){a=feed.process(a);var b=document.getElementById("latest_articles_feed");var e=[];if(!b){return}if(b.textContent=="loading feed..."){b.textContent=""}for(var d=0,f;f=a.value.items[d];++d){var c='<span class="classes">';if(f.category&&f.category.length){f.category.forEach(function(g){var h="class:";if(g.term.indexOf(h)==0){g.term=g.term.substring(h.length)}c+='<span class="class '+g.term+'"><span class="class_name">'+g.term+"</span></span>"})}c+="</span>";e.push('<li><span class="byline"><span class="date">',f.formattedDateStr,"</span> ",'<span class="author">',f.author?'<img src="/static/images/profiles/'+f.author+'.png" alt="">':"","</span></span>",'<span class="details"><span class="title">',f.title.link(f.link),"</span>",c)}b.innerHTML+=e.join("")},process:function(a){if(!a.value.items){return}for(var d=0,g;g=a.value.items[d];++d){var c=new Date(g.pubDate.split("T")[0].replace(/-/g,"/"));var b=c.getUTCMonth()+1+"/"+c.getUTCDate();var f="";if(g.author){f=g.author.name}var e="";if(g.id.match("www.html5rocks.com")||g.id.match("htmlfiverocks")){e="tutorial"}else{if(g.id.match("updates.html5rocks.com")){e="update"}}g.date=c;g.formattedDateStr=b;g.author=f;g.type=e}return a}};$.ajaxPrefilter(function(b,g,d){if(!Modernizr.localstorage||!b.localCache){return}var f;if(b.cacheKey){f=b.cacheKey}else{f=b.url+b.type+b.data}if(b.isCacheValid&&!b.isCacheValid()){localStorage.removeItem(f)}var a=localStorage.getItem(f+"cachettl");if(a&&a<+new Date()){localStorage.removeItem(f);localStorage.removeItem(f+"cachettl");a="expired"}var e=localStorage.getItem(f);if(e){b.success(e);d.abort()}else{if(b.success){var c=b.success;b.success=function(h){localStorage.setItem(f,h);c(h)}}else{b.success=function(h){localStorage.setItem(f,h)}}if(!a||a==="expired"){localStorage.setItem(f+"cachettl",+new Date()+1000*60*60*5)}}});if(AJAXIFY_SITE){window.addEventListener("popstate",state,false)}window.addEventListener("DOMContentLoaded",route.onload,false);